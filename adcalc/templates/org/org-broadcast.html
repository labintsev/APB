<!-- templates/org-broadcast.html - Update the table to show frequency and power -->
{% extends "base.html" %}

{% block title %}Трансляции{% endblock %}

{% block content %}
<div class="container">

  <div class="card">
    <h2>Трансляции для {{ organisation.name }}</h2>

    <h4>Создать новую трансляцию</h4>
    <form method="POST" action="{{ url_for('org.broadcast_create', org_id=organisation.id) }}">

      <div class="form-group">
        <label for="smi_id">СМИ:</label>
        <select class="form-control" id="smi_id" name="smi_id" required>
          {% for smi in smis %}
          <option value="{{ smi.id }}">{{ smi.name }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="form-group">
        <label for="district_id">Район:</label>
        <select class="form-control" id="district_id" name="district_id" required>
          {% for district in districts %}
          <option value="{{ district.id }}">{{ district.name }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="form-group">
        <label for="frequency">Частота:</label>
        <input type="text" class="form-control" id="frequency" name="frequency">
      </div>

      <div class="form-group">
        <label for="power">Мощность:</label>
        <input type="number" class="form-control" id="power" name="power" step="0.01">
      </div>

      <button type="submit" class="btn btn-primary">Создать трансляцию</button>
    </form>
  </div>

  <div class="card">
    <div class="table-wrap">
      <table class="app-table">
        <thead>
          <tr>
            <th>СМИ</th>
            <th>Рейтинг СМИ</th>
            <th>Район</th>
            <th>Население</th>
            <th>Коэф. региона</th>
            <th>Частота</th>
            <th>Мощность</th>
            <th>Цена 1 секунды</th>
          </tr>
        </thead>
        <tbody>
          {% for broadcast in organisation.broadcasts %}
          <tr>
            <td>
              <a href="{{ url_for('org.broadcast_update', bro_id=broadcast.id) }}"> {{ broadcast.smi.name }} </a>
            </td>
            <td>{{ broadcast.smi.rating }}</td>
            <td>{{ broadcast.district.name }}</td>
            <td>{{ broadcast.district.population }} т.чел.</td>
            <td>{{ broadcast.district.region.rating }}</td>
            <td>{{ broadcast.frequency or '-' }} МГц</td>
            <td>{{ broadcast.power or '-' }} кВт</td>
            <td> {{ "%.1f" | format(calculate_cost(broadcast)) }} р.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>


</div>
{% endblock %}